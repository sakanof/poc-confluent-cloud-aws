apiVersion: v1
kind: ConfigMap
metadata:
  name: client-properties-configmap-producer
  namespace: ${APPLICATION_NAMESPACE}
data:
  client_iam.properties: |
    security.protocol=SASL_SSL
    sasl.mechanism=OAUTHBEARER
    sasl.oauthbearer.token.file=/var/run/secrets/eks.amazonaws.com/serviceaccount/token
    sasl.login.callback.handler.class=io.confluent.oauth.aws.serviceaccount.OAuthBearerLoginCallbackHandler
    sasl.jaas.config= \
       org.apache.kafka.common.security.oauthbearer.OAuthBearerLoginModule required \
           clientId='ignored' \
           clientSecret='ignored' \
           extension_logicalCluster='${CLUSTER_ID}' \
           extension_identityPoolId='${PRODUCER_IDENTITY_POOL_ID}';
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: client-properties-configmap-consumer
  namespace: ${APPLICATION_NAMESPACE}
data:
  client_iam.properties: |
    security.protocol=SASL_SSL
    sasl.mechanism=OAUTHBEARER
    sasl.oauthbearer.token.file=/var/run/secrets/eks.amazonaws.com/serviceaccount/token
    sasl.login.callback.handler.class=io.confluent.oauth.aws.serviceaccount.OAuthBearerLoginCallbackHandler
    sasl.jaas.config= \
       org.apache.kafka.common.security.oauthbearer.OAuthBearerLoginModule required \
           clientId='ignored' \
           clientSecret='ignored' \
           extension_logicalCluster='${CLUSTER_ID}' \
           extension_identityPoolId='${CONSUMER_IDENTITY_POOL_ID}';
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: client-properties-configmap-topic-owner
  namespace: ${APPLICATION_NAMESPACE}
data:
  client_iam.properties: |
    security.protocol=SASL_SSL
    sasl.mechanism=OAUTHBEARER
    sasl.oauthbearer.token.file=/var/run/secrets/eks.amazonaws.com/serviceaccount/token
    sasl.login.callback.handler.class=io.confluent.oauth.aws.serviceaccount.OAuthBearerLoginCallbackHandler
    sasl.jaas.config= \
       org.apache.kafka.common.security.oauthbearer.OAuthBearerLoginModule required \
           clientId='ignored' \
           clientSecret='ignored' \
           extension_logicalCluster='${CLUSTER_ID}' \
           extension_identityPoolId='${TOPIC_OWNER_IDENTITY_POOL_ID}';
